Loading DPO dataset...
Loading tokenizer...
Loading Base Model (4-bit)...
Loading SFT Adapter from ./models/smollm-360m-tool-calling-final (Trainable)...
trainable params: 8,683,520 || all params: 370,504,640 || trainable%: 2.3437
Applying chat template to train dataset:   0%|          | 0/10000 [00:00<?, ? examples/s]Applying chat template to train dataset:  26%|██▌       | 2600/10000 [00:00<00:00, 25826.81 examples/s]Applying chat template to train dataset:  53%|█████▎    | 5271/10000 [00:00<00:00, 26325.99 examples/s]Applying chat template to train dataset:  80%|███████▉  | 7951/10000 [00:00<00:00, 26534.11 examples/s]Applying chat template to train dataset: 100%|██████████| 10000/10000 [00:00<00:00, 26063.10 examples/s]
Tokenizing train dataset:   0%|          | 0/10000 [00:00<?, ? examples/s]Tokenizing train dataset:   2%|▏         | 236/10000 [00:00<00:04, 2345.28 examples/s]Tokenizing train dataset:   5%|▍         | 479/10000 [00:00<00:03, 2380.81 examples/s]Tokenizing train dataset:   8%|▊         | 833/10000 [00:00<00:03, 2364.05 examples/s]Tokenizing train dataset:  11%|█         | 1074/10000 [00:00<00:03, 2378.05 examples/s]Tokenizing train dataset:  14%|█▍        | 1413/10000 [00:00<00:03, 2324.88 examples/s]Tokenizing train dataset:  17%|█▋        | 1656/10000 [00:00<00:03, 2352.99 examples/s]Tokenizing train dataset:  19%|█▉        | 1900/10000 [00:00<00:03, 2372.46 examples/s]Tokenizing train dataset:  22%|██▏       | 2152/10000 [00:00<00:03, 2413.66 examples/s]Tokenizing train dataset:  24%|██▍       | 2401/10000 [00:01<00:03, 2433.53 examples/s]Tokenizing train dataset:  26%|██▋       | 2650/10000 [00:01<00:03, 2446.39 examples/s]Tokenizing train dataset:  29%|██▉       | 2901/10000 [00:01<00:02, 2461.75 examples/s]Tokenizing train dataset:  33%|███▎      | 3263/10000 [00:01<00:02, 2437.99 examples/s]Tokenizing train dataset:  36%|███▌      | 3620/10000 [00:01<00:02, 2413.36 examples/s]Tokenizing train dataset:  39%|███▊      | 3864/10000 [00:01<00:02, 2418.37 examples/s]Tokenizing train dataset:  41%|████      | 4110/10000 [00:01<00:02, 2424.71 examples/s]Tokenizing train dataset:  45%|████▍     | 4472/10000 [00:01<00:02, 2415.34 examples/s]Tokenizing train dataset:  47%|████▋     | 4720/10000 [00:01<00:02, 2427.02 examples/s]Tokenizing train dataset:  51%|█████     | 5070/10000 [00:02<00:02, 2391.62 examples/s]Tokenizing train dataset:  53%|█████▎    | 5319/10000 [00:02<00:01, 2414.99 examples/s]Tokenizing train dataset:  56%|█████▌    | 5571/10000 [00:02<00:01, 2440.36 examples/s]Tokenizing train dataset:  58%|█████▊    | 5824/10000 [00:02<00:01, 2462.56 examples/s]Tokenizing train dataset:  61%|██████    | 6076/10000 [00:02<00:01, 2474.97 examples/s]Tokenizing train dataset:  64%|██████▍   | 6440/10000 [00:02<00:01, 2449.43 examples/s]Tokenizing train dataset:  67%|██████▋   | 6688/10000 [00:02<00:01, 2453.78 examples/s]Tokenizing train dataset:  71%|███████   | 7054/10000 [00:02<00:01, 2443.13 examples/s]Tokenizing train dataset:  73%|███████▎  | 7303/10000 [00:03<00:01, 2452.28 examples/s]Tokenizing train dataset:  77%|███████▋  | 7671/10000 [00:03<00:00, 2449.12 examples/s]Tokenizing train dataset:  79%|███████▉  | 7921/10000 [00:03<00:00, 2459.34 examples/s]Tokenizing train dataset:  83%|████████▎ | 8263/10000 [00:03<00:00, 2393.14 examples/s]Tokenizing train dataset:  85%|████████▌ | 8508/10000 [00:03<00:00, 2405.89 examples/s]Tokenizing train dataset:  88%|████████▊ | 8759/10000 [00:03<00:00, 2431.12 examples/s]Tokenizing train dataset:  90%|█████████ | 9009/10000 [00:03<00:00, 2448.41 examples/s]Tokenizing train dataset:  93%|█████████▎| 9256/10000 [00:03<00:00, 2450.64 examples/s]Tokenizing train dataset:  95%|█████████▌| 9503/10000 [00:03<00:00, 2455.26 examples/s]Tokenizing train dataset:  99%|█████████▊| 9871/10000 [00:04<00:00, 2452.82 examples/s]Tokenizing train dataset: 100%|██████████| 10000/10000 [00:04<00:00, 2373.63 examples/s]
Starting DPO training for SmolLM...
  0%|          | 0/625 [00:00<?, ?it/s]/data/b22cs093/miniconda3/envs/dl/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|          | 1/625 [00:05<54:11,  5.21s/it]  0%|          | 2/625 [00:08<45:23,  4.37s/it]  0%|          | 3/625 [00:13<44:15,  4.27s/it]  1%|          | 4/625 [00:17<45:13,  4.37s/it]  1%|          | 5/625 [00:21<43:56,  4.25s/it]  1%|          | 6/625 [00:25<40:39,  3.94s/it]  1%|          | 7/625 [00:28<39:37,  3.85s/it]  1%|▏         | 8/625 [00:33<41:56,  4.08s/it]  1%|▏         | 9/625 [00:37<41:48,  4.07s/it]  2%|▏         | 10/625 [00:40<40:12,  3.92s/it]                                                  2%|▏         | 10/625 [00:40<40:12,  3.92s/it]  2%|▏         | 11/625 [00:44<40:04,  3.92s/it]  2%|▏         | 12/625 [00:48<39:31,  3.87s/it]  2%|▏         | 13/625 [00:52<40:50,  4.00s/it]  2%|▏         | 14/625 [00:57<41:09,  4.04s/it]  2%|▏         | 15/625 [01:00<40:27,  3.98s/it]  3%|▎         | 16/625 [01:04<39:18,  3.87s/it]  3%|▎         | 17/625 [01:08<39:19,  3.88s/it]  3%|▎         | 18/625 [01:12<39:59,  3.95s/it]  3%|▎         | 19/625 [01:16<39:10,  3.88s/it]  3%|▎         | 20/625 [01:20<39:24,  3.91s/it]                                                  3%|▎         | 20/625 [01:20<39:24,  3.91s/it]  3%|▎         | 21/625 [01:24<39:26,  3.92s/it]  4%|▎         | 22/625 [01:28<40:52,  4.07s/it]  4%|▎         | 23/625 [01:33<44:31,  4.44s/it]  4%|▍         | 24/625 [01:37<42:51,  4.28s/it]  4%|▍         | 25/625 [01:41<41:28,  4.15s/it]  4%|▍         | 26/625 [01:45<41:16,  4.14s/it]  4%|▍         | 27/625 [01:49<40:10,  4.03s/it]  4%|▍         | 28/625 [01:54<43:43,  4.39s/it]  5%|▍         | 29/625 [01:58<42:13,  4.25s/it]  5%|▍         | 30/625 [02:05<49:21,  4.98s/it]                                                  5%|▍         | 30/625 [02:05<49:21,  4.98s/it]  5%|▍         | 31/625 [02:09<47:37,  4.81s/it]  5%|▌         | 32/625 [02:14<46:17,  4.68s/it]  5%|▌         | 33/625 [02:17<43:40,  4.43s/it]  5%|▌         | 34/625 [02:22<43:03,  4.37s/it]  6%|▌         | 35/625 [02:25<40:07,  4.08s/it]  6%|▌         | 36/625 [02:29<39:04,  3.98s/it]  6%|▌         | 37/625 [02:33<38:04,  3.89s/it]  6%|▌         | 38/625 [02:36<37:44,  3.86s/it]  6%|▌         | 39/625 [02:40<38:00,  3.89s/it]  6%|▋         | 40/625 [02:44<38:04,  3.90s/it]                                                  6%|▋         | 40/625 [02:44<38:04,  3.90s/it]  7%|▋         | 41/625 [02:48<38:00,  3.90s/it]  7%|▋         | 42/625 [02:52<36:48,  3.79s/it]  7%|▋         | 43/625 [02:55<36:36,  3.77s/it]  7%|▋         | 44/625 [02:59<36:57,  3.82s/it]  7%|▋         | 45/625 [03:03<37:05,  3.84s/it]  7%|▋         | 46/625 [03:07<37:30,  3.89s/it]  8%|▊         | 47/625 [03:11<36:49,  3.82s/it]  8%|▊         | 48/625 [03:15<37:07,  3.86s/it]  8%|▊         | 49/625 [03:19<36:42,  3.82s/it]  8%|▊         | 50/625 [03:22<36:29,  3.81s/it]                                                  8%|▊         | 50/625 [03:22<36:29,  3.81s/it]  8%|▊         | 51/625 [03:26<37:03,  3.87s/it]  8%|▊         | 52/625 [03:30<37:19,  3.91s/it]  8%|▊         | 53/625 [03:35<39:33,  4.15s/it]  9%|▊         | 54/625 [03:39<38:00,  3.99s/it]  9%|▉         | 55/625 [03:43<38:49,  4.09s/it]  9%|▉         | 56/625 [03:47<38:16,  4.04s/it]  9%|▉         | 57/625 [03:51<37:31,  3.96s/it]  9%|▉         | 58/625 [03:55<38:00,  4.02s/it]  9%|▉         | 59/625 [03:59<37:59,  4.03s/it] 10%|▉         | 60/625 [04:03<37:49,  4.02s/it]                                                 10%|▉         | 60/625 [04:03<37:49,  4.02s/it] 10%|▉         | 61/625 [04:07<37:54,  4.03s/it] 10%|▉         | 62/625 [04:11<36:46,  3.92s/it] 10%|█         | 63/625 [04:15<37:02,  3.95s/it] 10%|█         | 64/625 [04:19<37:49,  4.05s/it] 10%|█         | 65/625 [04:23<37:02,  3.97s/it] 11%|█         | 66/625 [04:26<35:16,  3.79s/it] 11%|█         | 67/625 [04:29<32:42,  3.52s/it] 11%|█         | 68/625 [04:32<30:57,  3.33s/it] 11%|█         | 69/625 [04:35<30:42,  3.31s/it] 11%|█         | 70/625 [04:38<30:00,  3.24s/it]                                                 11%|█         | 70/625 [04:38<30:00,  3.24s/it] 11%|█▏        | 71/625 [04:43<33:14,  3.60s/it] 12%|█▏        | 72/625 [04:47<35:13,  3.82s/it] 12%|█▏        | 73/625 [04:51<35:47,  3.89s/it] 12%|█▏        | 74/625 [04:55<36:11,  3.94s/it] 12%|█▏        | 75/625 [04:59<35:09,  3.83s/it] 12%|█▏        | 76/625 [05:03<35:21,  3.86s/it] 12%|█▏        | 77/625 [05:07<35:48,  3.92s/it] 12%|█▏        | 78/625 [05:11<36:16,  3.98s/it] 13%|█▎        | 79/625 [05:15<37:15,  4.09s/it] 13%|█▎        | 80/625 [05:19<35:37,  3.92s/it]                                                 13%|█▎        | 80/625 [05:19<35:37,  3.92s/it] 13%|█▎        | 81/625 [05:22<35:16,  3.89s/it] 13%|█▎        | 82/625 [05:27<35:57,  3.97s/it] 13%|█▎        | 83/625 [05:30<35:07,  3.89s/it] 13%|█▎        | 84/625 [05:34<34:30,  3.83s/it] 14%|█▎        | 85/625 [05:38<34:28,  3.83s/it] 14%|█▍        | 86/625 [05:42<34:47,  3.87s/it] 14%|█▍        | 87/625 [05:45<33:14,  3.71s/it] 14%|█▍        | 88/625 [05:49<33:14,  3.71s/it] 14%|█▍        | 89/625 [05:53<33:34,  3.76s/it] 14%|█▍        | 90/625 [05:56<33:32,  3.76s/it]                                                 14%|█▍        | 90/625 [05:57<33:32,  3.76s/it] 15%|█▍        | 91/625 [06:01<34:14,  3.85s/it] 15%|█▍        | 92/625 [06:04<34:14,  3.85s/it] 15%|█▍        | 93/625 [06:08<34:15,  3.86s/it] 15%|█▌        | 94/625 [06:12<33:38,  3.80s/it] 15%|█▌        | 95/625 [06:16<34:52,  3.95s/it] 15%|█▌        | 96/625 [06:20<34:04,  3.86s/it] 16%|█▌        | 97/625 [06:24<34:07,  3.88s/it] 16%|█▌        | 98/625 [06:28<34:01,  3.87s/it] 16%|█▌        | 99/625 [06:32<35:12,  4.02s/it] 16%|█▌        | 100/625 [06:36<34:13,  3.91s/it]                                                  16%|█▌        | 100/625 [06:36<34:13,  3.91s/it]/data/b22cs093/miniconda3/envs/dl/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
 16%|█▌        | 101/625 [06:41<37:30,  4.30s/it] 16%|█▋        | 102/625 [06:44<35:01,  4.02s/it] 16%|█▋        | 103/625 [06:48<34:31,  3.97s/it] 17%|█▋        | 104/625 [06:52<34:10,  3.94s/it] 17%|█▋        | 105/625 [06:56<33:40,  3.88s/it] 17%|█▋        | 106/625 [07:01<36:10,  4.18s/it] 17%|█▋        | 107/625 [07:05<35:55,  4.16s/it] 17%|█▋        | 108/625 [07:09<35:56,  4.17s/it] 17%|█▋        | 109/625 [07:14<37:04,  4.31s/it] 18%|█▊        | 110/625 [07:18<36:35,  4.26s/it]                                                  18%|█▊        | 110/625 [07:18<36:35,  4.26s/it] 18%|█▊        | 111/625 [07:22<35:22,  4.13s/it] 18%|█▊        | 112/625 [07:25<34:45,  4.07s/it] 18%|█▊        | 113/625 [07:30<35:36,  4.17s/it] 18%|█▊        | 114/625 [07:34<35:27,  4.16s/it] 18%|█▊        | 115/625 [07:38<35:57,  4.23s/it] 19%|█▊        | 116/625 [07:42<34:49,  4.10s/it] 19%|█▊        | 117/625 [07:46<34:36,  4.09s/it] 19%|█▉        | 118/625 [07:51<35:07,  4.16s/it] 19%|█▉        | 119/625 [07:55<34:33,  4.10s/it] 19%|█▉        | 120/625 [07:58<33:27,  3.97s/it]                                                  19%|█▉        | 120/625 [07:58<33:27,  3.97s/it] 19%|█▉        | 121/625 [08:02<32:33,  3.88s/it] 20%|█▉        | 122/625 [08:06<32:39,  3.89s/it] 20%|█▉        | 123/625 [08:10<33:38,  4.02s/it] 20%|█▉        | 124/625 [08:15<34:50,  4.17s/it] 20%|██        | 125/625 [08:19<34:44,  4.17s/it] 20%|██        | 126/625 [08:22<33:18,  4.01s/it] 20%|██        | 127/625 [08:27<33:26,  4.03s/it] 20%|██        | 128/625 [08:30<31:47,  3.84s/it] 21%|██        | 129/625 [08:34<32:54,  3.98s/it] 21%|██        | 130/625 [08:38<31:53,  3.87s/it]                                                  21%|██        | 130/625 [08:38<31:53,  3.87s/it] 21%|██        | 131/625 [08:42<32:29,  3.95s/it] 21%|██        | 132/625 [08:47<35:03,  4.27s/it] 21%|██▏       | 133/625 [08:51<34:43,  4.23s/it] 21%|██▏       | 134/625 [08:55<34:35,  4.23s/it] 22%|██▏       | 135/625 [08:59<33:59,  4.16s/it] 22%|██▏       | 136/625 [09:03<32:02,  3.93s/it] 22%|██▏       | 137/625 [09:06<31:28,  3.87s/it] 22%|██▏       | 138/625 [09:10<30:44,  3.79s/it] 22%|██▏       | 139/625 [09:14<31:32,  3.89s/it] 22%|██▏       | 140/625 [09:18<31:58,  3.96s/it]                                                  22%|██▏       | 140/625 [09:18<31:58,  3.96s/it] 23%|██▎       | 141/625 [09:22<31:37,  3.92s/it] 23%|██▎       | 142/625 [09:26<31:39,  3.93s/it] 23%|██▎       | 143/625 [09:30<31:02,  3.86s/it] 23%|██▎       | 144/625 [09:34<32:00,  3.99s/it] 23%|██▎       | 145/625 [09:38<31:44,  3.97s/it] 23%|██▎       | 146/625 [09:42<31:07,  3.90s/it] 24%|██▎       | 147/625 [09:46<32:15,  4.05s/it] 24%|██▎       | 148/625 [09:50<32:11,  4.05s/it] 24%|██▍       | 149/625 [09:54<31:58,  4.03s/it] 24%|██▍       | 150/625 [09:58<32:24,  4.09s/it]                                                  24%|██▍       | 150/625 [09:58<32:24,  4.09s/it] 24%|██▍       | 151/625 [10:02<31:36,  4.00s/it] 24%|██▍       | 152/625 [10:06<31:52,  4.04s/it] 24%|██▍       | 153/625 [10:10<31:04,  3.95s/it] 25%|██▍       | 154/625 [10:14<30:55,  3.94s/it] 25%|██▍       | 155/625 [10:18<30:25,  3.88s/it] 25%|██▍       | 156/625 [10:21<29:31,  3.78s/it] 25%|██▌       | 157/625 [10:25<30:27,  3.90s/it] 25%|██▌       | 158/625 [10:30<30:48,  3.96s/it] 25%|██▌       | 159/625 [10:34<32:26,  4.18s/it] 26%|██▌       | 160/625 [10:39<33:53,  4.37s/it]                                                  26%|██▌       | 160/625 [10:39<33:53,  4.37s/it] 26%|██▌       | 161/625 [10:43<32:21,  4.18s/it] 26%|██▌       | 162/625 [10:48<33:55,  4.40s/it] 26%|██▌       | 163/625 [10:51<32:19,  4.20s/it] 26%|██▌       | 164/625 [10:55<31:42,  4.13s/it] 26%|██▋       | 165/625 [10:59<30:45,  4.01s/it] 27%|██▋       | 166/625 [11:03<30:00,  3.92s/it] 27%|██▋       | 167/625 [11:07<29:27,  3.86s/it] 27%|██▋       | 168/625 [11:10<29:25,  3.86s/it] 27%|██▋       | 169/625 [11:15<30:03,  3.95s/it] 27%|██▋       | 170/625 [11:19<30:05,  3.97s/it]                                                  27%|██▋       | 170/625 [11:19<30:05,  3.97s/it] 27%|██▋       | 171/625 [11:23<30:42,  4.06s/it] 28%|██▊       | 172/625 [11:27<31:09,  4.13s/it] 28%|██▊       | 173/625 [11:31<30:12,  4.01s/it] 28%|██▊       | 174/625 [11:37<34:09,  4.54s/it] 28%|██▊       | 175/625 [11:40<32:16,  4.30s/it] 28%|██▊       | 176/625 [11:44<31:05,  4.15s/it] 28%|██▊       | 177/625 [11:48<30:15,  4.05s/it] 28%|██▊       | 178/625 [11:52<29:11,  3.92s/it] 29%|██▊       | 179/625 [11:56<30:57,  4.17s/it] 29%|██▉       | 180/625 [12:01<31:00,  4.18s/it]                                                  29%|██▉       | 180/625 [12:01<31:00,  4.18s/it] 29%|██▉       | 181/625 [12:05<31:15,  4.22s/it] 29%|██▉       | 182/625 [12:09<30:08,  4.08s/it] 29%|██▉       | 183/625 [12:13<29:36,  4.02s/it] 29%|██▉       | 184/625 [12:17<29:27,  4.01s/it] 30%|██▉       | 185/625 [12:21<29:21,  4.00s/it] 30%|██▉       | 186/625 [12:25<29:29,  4.03s/it] 30%|██▉       | 187/625 [12:29<29:34,  4.05s/it] 30%|███       | 188/625 [12:33<28:55,  3.97s/it] 30%|███       | 189/625 [12:36<28:38,  3.94s/it] 30%|███       | 190/625 [12:40<28:25,  3.92s/it]                                                  30%|███       | 190/625 [12:40<28:25,  3.92s/it] 31%|███       | 191/625 [12:44<28:08,  3.89s/it] 31%|███       | 192/625 [12:48<27:42,  3.84s/it] 31%|███       | 193/625 [12:52<27:47,  3.86s/it] 31%|███       | 194/625 [12:56<28:50,  4.02s/it] 31%|███       | 195/625 [13:00<28:49,  4.02s/it] 31%|███▏      | 196/625 [13:04<28:31,  3.99s/it] 32%|███▏      | 197/625 [13:08<28:23,  3.98s/it] 32%|███▏      | 198/625 [13:12<27:37,  3.88s/it] 32%|███▏      | 199/625 [13:15<27:10,  3.83s/it] 32%|███▏      | 200/625 [13:19<26:51,  3.79s/it]                                                  32%|███▏      | 200/625 [13:19<26:51,  3.79s/it]/data/b22cs093/miniconda3/envs/dl/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
 32%|███▏      | 201/625 [13:24<28:58,  4.10s/it] 32%|███▏      | 202/625 [13:27<27:49,  3.95s/it] 32%|███▏      | 203/625 [13:32<28:34,  4.06s/it] 33%|███▎      | 204/625 [13:36<28:33,  4.07s/it] 33%|███▎      | 205/625 [13:40<29:03,  4.15s/it] 33%|███▎      | 206/625 [13:45<29:19,  4.20s/it] 33%|███▎      | 207/625 [13:48<28:24,  4.08s/it] 33%|███▎      | 208/625 [13:52<28:10,  4.05s/it] 33%|███▎      | 209/625 [13:56<27:47,  4.01s/it] 34%|███▎      | 210/625 [14:00<26:44,  3.87s/it]                                                 {'loss': 0.2778, 'grad_norm': 0.7809650301933289, 'learning_rate': 9.856000000000002e-06, 'rewards/chosen': 7.564067840576172, 'rewards/rejected': 6.049990653991699, 'rewards/accuracies': 0.9312499761581421, 'rewards/margins': 1.5140780210494995, 'logps/chosen': -7.664259433746338, 'logps/rejected': -29.761581420898438, 'logits/chosen': -2.983564615249634, 'logits/rejected': -2.986609697341919, 'epoch': 0.02}
{'loss': 0.2457, 'grad_norm': 1.157283902168274, 'learning_rate': 9.696000000000002e-06, 'rewards/chosen': 7.2842116355896, 'rewards/rejected': 5.494506359100342, 'rewards/accuracies': 0.949999988079071, 'rewards/margins': 1.789705514907837, 'logps/chosen': -9.073847770690918, 'logps/rejected': -33.64885711669922, 'logits/chosen': -3.100987672805786, 'logits/rejected': -3.079108476638794, 'epoch': 0.03}
{'loss': 0.2149, 'grad_norm': 0.9910480976104736, 'learning_rate': 9.536000000000002e-06, 'rewards/chosen': 7.333006381988525, 'rewards/rejected': 5.390981674194336, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 1.9420251846313477, 'logps/chosen': -10.791483879089355, 'logps/rejected': -39.20392608642578, 'logits/chosen': -3.189584970474243, 'logits/rejected': -3.145285129547119, 'epoch': 0.05}
{'loss': 0.1684, 'grad_norm': 1.119611144065857, 'learning_rate': 9.376000000000001e-06, 'rewards/chosen': 7.33994197845459, 'rewards/rejected': 4.9852118492126465, 'rewards/accuracies': 0.96875, 'rewards/margins': 2.3547303676605225, 'logps/chosen': -9.478555679321289, 'logps/rejected': -41.186607360839844, 'logits/chosen': -3.1020123958587646, 'logits/rejected': -3.0841994285583496, 'epoch': 0.06}
{'loss': 0.1592, 'grad_norm': 1.0756536722183228, 'learning_rate': 9.216000000000001e-06, 'rewards/chosen': 6.996438503265381, 'rewards/rejected': 4.6795549392700195, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 2.3168835639953613, 'logps/chosen': -10.859234809875488, 'logps/rejected': -40.43134689331055, 'logits/chosen': -3.1404852867126465, 'logits/rejected': -3.1174111366271973, 'epoch': 0.08}
{'loss': 0.1297, 'grad_norm': 0.7573703527450562, 'learning_rate': 9.056000000000001e-06, 'rewards/chosen': 6.925925254821777, 'rewards/rejected': 4.272797584533691, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 2.6531286239624023, 'logps/chosen': -9.525093078613281, 'logps/rejected': -42.65415573120117, 'logits/chosen': -3.205827236175537, 'logits/rejected': -3.1512932777404785, 'epoch': 0.1}
{'loss': 0.1311, 'grad_norm': 1.055530309677124, 'learning_rate': 8.896000000000001e-06, 'rewards/chosen': 7.092999458312988, 'rewards/rejected': 4.400179862976074, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 2.6928188800811768, 'logps/chosen': -12.206571578979492, 'logps/rejected': -46.576866149902344, 'logits/chosen': -3.334804058074951, 'logits/rejected': -3.269458770751953, 'epoch': 0.11}
{'loss': 0.0832, 'grad_norm': 0.7197549939155579, 'learning_rate': 8.736e-06, 'rewards/chosen': 6.997101783752441, 'rewards/rejected': 3.704867124557495, 'rewards/accuracies': 0.9937499761581421, 'rewards/margins': 3.292234420776367, 'logps/chosen': -15.203353881835938, 'logps/rejected': -52.89201736450195, 'logits/chosen': -3.423689365386963, 'logits/rejected': -3.3673202991485596, 'epoch': 0.13}
{'loss': 0.0694, 'grad_norm': 0.646729052066803, 'learning_rate': 8.576e-06, 'rewards/chosen': 6.436074256896973, 'rewards/rejected': 3.058946132659912, 'rewards/accuracies': 1.0, 'rewards/margins': 3.377129316329956, 'logps/chosen': -13.186391830444336, 'logps/rejected': -55.3460693359375, 'logits/chosen': -3.366925001144409, 'logits/rejected': -3.316682815551758, 'epoch': 0.14}
{'loss': 0.0734, 'grad_norm': 0.25208571553230286, 'learning_rate': 8.416e-06, 'rewards/chosen': 6.412407875061035, 'rewards/rejected': 2.974116563796997, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 3.438291072845459, 'logps/chosen': -16.397050857543945, 'logps/rejected': -57.825233459472656, 'logits/chosen': -3.379626750946045, 'logits/rejected': -3.328728199005127, 'epoch': 0.16}
{'loss': 0.0718, 'grad_norm': 0.758764922618866, 'learning_rate': 8.256e-06, 'rewards/chosen': 6.3366241455078125, 'rewards/rejected': 2.701378345489502, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 3.6352462768554688, 'logps/chosen': -17.83035659790039, 'logps/rejected': -61.86682891845703, 'logits/chosen': -3.3795528411865234, 'logits/rejected': -3.3167805671691895, 'epoch': 0.18}
{'loss': 0.074, 'grad_norm': 0.7280341982841492, 'learning_rate': 8.096e-06, 'rewards/chosen': 6.428825378417969, 'rewards/rejected': 2.861086368560791, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 3.567739963531494, 'logps/chosen': -20.114593505859375, 'logps/rejected': -62.77912139892578, 'logits/chosen': -3.401968479156494, 'logits/rejected': -3.3456597328186035, 'epoch': 0.19}
{'loss': 0.0681, 'grad_norm': 0.3179910480976105, 'learning_rate': 7.936e-06, 'rewards/chosen': 6.123160362243652, 'rewards/rejected': 2.2817912101745605, 'rewards/accuracies': 0.96875, 'rewards/margins': 3.841369152069092, 'logps/chosen': -18.680034637451172, 'logps/rejected': -64.6942138671875, 'logits/chosen': -3.469750165939331, 'logits/rejected': -3.359726667404175, 'epoch': 0.21}
{'loss': 0.078, 'grad_norm': 0.5609205961227417, 'learning_rate': 7.776e-06, 'rewards/chosen': 6.055521488189697, 'rewards/rejected': 2.349466323852539, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 3.7060554027557373, 'logps/chosen': -19.733924865722656, 'logps/rejected': -64.16264343261719, 'logits/chosen': -3.3461697101593018, 'logits/rejected': -3.2879669666290283, 'epoch': 0.22}
{'loss': 0.06, 'grad_norm': 0.260956734418869, 'learning_rate': 7.616000000000001e-06, 'rewards/chosen': 5.993691444396973, 'rewards/rejected': 2.185586452484131, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 3.8081047534942627, 'logps/chosen': -21.776782989501953, 'logps/rejected': -68.42237091064453, 'logits/chosen': -3.309724807739258, 'logits/rejected': -3.239565372467041, 'epoch': 0.24}
{'loss': 0.0659, 'grad_norm': 0.6872456073760986, 'learning_rate': 7.456000000000001e-06, 'rewards/chosen': 6.204823970794678, 'rewards/rejected': 2.338984251022339, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 3.8658394813537598, 'logps/chosen': -22.510652542114258, 'logps/rejected': -67.52366638183594, 'logits/chosen': -3.4271163940429688, 'logits/rejected': -3.363996982574463, 'epoch': 0.26}
{'loss': 0.0486, 'grad_norm': 0.8624061942100525, 'learning_rate': 7.296000000000001e-06, 'rewards/chosen': 6.157195091247559, 'rewards/rejected': 2.0216548442840576, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 4.135540008544922, 'logps/chosen': -18.907869338989258, 'logps/rejected': -67.90187072753906, 'logits/chosen': -3.564584732055664, 'logits/rejected': -3.516963243484497, 'epoch': 0.27}
{'loss': 0.0514, 'grad_norm': 0.8215623497962952, 'learning_rate': 7.136000000000001e-06, 'rewards/chosen': 6.152480602264404, 'rewards/rejected': 2.092252254486084, 'rewards/accuracies': 1.0, 'rewards/margins': 4.060227870941162, 'logps/chosen': -23.067859649658203, 'logps/rejected': -71.89186096191406, 'logits/chosen': -3.348966598510742, 'logits/rejected': -3.3125481605529785, 'epoch': 0.29}
{'loss': 0.0466, 'grad_norm': 0.21124869585037231, 'learning_rate': 6.976000000000001e-06, 'rewards/chosen': 6.097771644592285, 'rewards/rejected': 1.6701202392578125, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 4.427651882171631, 'logps/chosen': -21.387418746948242, 'logps/rejected': -73.37214660644531, 'logits/chosen': -3.4622511863708496, 'logits/rejected': -3.3977115154266357, 'epoch': 0.3}
{'loss': 0.0494, 'grad_norm': 1.3476496934890747, 'learning_rate': 6.8160000000000005e-06, 'rewards/chosen': 5.971113681793213, 'rewards/rejected': 1.7457058429718018, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 4.225407600402832, 'logps/chosen': -19.63343048095703, 'logps/rejected': -69.6769027709961, 'logits/chosen': -3.512305736541748, 'logits/rejected': -3.5119080543518066, 'epoch': 0.32}
 34%|███▎      | 210/625 [14:00<26:44,  3.87s/it] 34%|███▍      | 211/625 [14:04<27:15,  3.95s/it] 34%|███▍      | 212/625 [14:08<26:30,  3.85s/it] 34%|███▍      | 213/625 [14:12<26:42,  3.89s/it] 34%|███▍      | 214/625 [14:16<27:16,  3.98s/it] 34%|███▍      | 215/625 [14:20<27:20,  4.00s/it] 35%|███▍      | 216/625 [14:23<26:36,  3.90s/it] 35%|███▍      | 217/625 [14:27<26:30,  3.90s/it] 35%|███▍      | 218/625 [14:32<27:05,  3.99s/it] 35%|███▌      | 219/625 [14:35<26:46,  3.96s/it] 35%|███▌      | 220/625 [14:38<24:53,  3.69s/it]                                                  35%|███▌      | 220/625 [14:38<24:53,  3.69s/it] 35%|███▌      | 221/625 [14:41<23:19,  3.46s/it] 36%|███▌      | 222/625 [14:44<22:04,  3.29s/it] 36%|███▌      | 223/625 [14:47<21:31,  3.21s/it] 36%|███▌      | 224/625 [14:51<21:25,  3.21s/it] 36%|███▌      | 225/625 [14:54<22:11,  3.33s/it] 36%|███▌      | 226/625 [14:58<23:04,  3.47s/it] 36%|███▋      | 227/625 [15:02<24:09,  3.64s/it] 36%|███▋      | 228/625 [15:06<24:20,  3.68s/it] 37%|███▋      | 229/625 [15:10<25:15,  3.83s/it] 37%|███▋      | 230/625 [15:14<26:06,  3.97s/it]                                                  37%|███▋      | 230/625 [15:14<26:06,  3.97s/it] 37%|███▋      | 231/625 [15:20<29:59,  4.57s/it] 37%|███▋      | 232/625 [15:24<28:23,  4.34s/it] 37%|███▋      | 233/625 [15:28<27:15,  4.17s/it] 37%|███▋      | 234/625 [15:32<26:43,  4.10s/it] 38%|███▊      | 235/625 [15:35<25:55,  3.99s/it] 38%|███▊      | 236/625 [15:40<26:21,  4.07s/it] 38%|███▊      | 237/625 [15:44<26:02,  4.03s/it] 38%|███▊      | 238/625 [15:48<25:56,  4.02s/it] 38%|███▊      | 239/625 [15:52<25:43,  4.00s/it] 38%|███▊      | 240/625 [15:55<25:16,  3.94s/it]                                                  38%|███▊      | 240/625 [15:55<25:16,  3.94s/it] 39%|███▊      | 241/625 [15:59<24:54,  3.89s/it] 39%|███▊      | 242/625 [16:03<24:42,  3.87s/it] 39%|███▉      | 243/625 [16:07<25:14,  3.96s/it] 39%|███▉      | 244/625 [16:12<26:24,  4.16s/it] 39%|███▉      | 245/625 [16:15<24:57,  3.94s/it] 39%|███▉      | 246/625 [16:19<24:46,  3.92s/it] 40%|███▉      | 247/625 [16:23<24:24,  3.88s/it] 40%|███▉      | 248/625 [16:27<24:12,  3.85s/it] 40%|███▉      | 249/625 [16:30<24:07,  3.85s/it] 40%|████      | 250/625 [16:34<24:18,  3.89s/it]                                                  40%|████      | 250/625 [16:34<24:18,  3.89s/it] 40%|████      | 251/625 [16:38<23:27,  3.76s/it] 40%|████      | 252/625 [16:43<26:17,  4.23s/it] 40%|████      | 253/625 [16:47<24:51,  4.01s/it] 41%|████      | 254/625 [16:50<24:06,  3.90s/it] 41%|████      | 255/625 [16:54<23:51,  3.87s/it] 41%|████      | 256/625 [16:58<22:47,  3.71s/it] 41%|████      | 257/625 [17:01<23:13,  3.79s/it] 41%|████▏     | 258/625 [17:05<23:13,  3.80s/it] 41%|████▏     | 259/625 [17:10<24:22,  4.00s/it] 42%|████▏     | 260/625 [17:14<24:35,  4.04s/it]                                                  42%|████▏     | 260/625 [17:14<24:35,  4.04s/it] 42%|████▏     | 261/625 [17:18<24:13,  3.99s/it] 42%|████▏     | 262/625 [17:22<24:23,  4.03s/it] 42%|████▏     | 263/625 [17:27<25:21,  4.20s/it] 42%|████▏     | 264/625 [17:31<25:24,  4.22s/it] 42%|████▏     | 265/625 [17:35<25:04,  4.18s/it] 43%|████▎     | 266/625 [17:39<24:54,  4.16s/it] 43%|████▎     | 267/625 [17:43<24:42,  4.14s/it] 43%|████▎     | 268/625 [17:47<24:13,  4.07s/it] 43%|████▎     | 269/625 [17:51<23:44,  4.00s/it] 43%|████▎     | 270/625 [17:56<24:55,  4.21s/it]                                                  43%|████▎     | 270/625 [17:56<24:55,  4.21s/it] 43%|████▎     | 271/625 [17:59<23:42,  4.02s/it] 44%|████▎     | 272/625 [18:03<23:53,  4.06s/it] 44%|████▎     | 273/625 [18:07<23:58,  4.09s/it] 44%|████▍     | 274/625 [18:11<23:38,  4.04s/it] 44%|████▍     | 275/625 [18:15<23:13,  3.98s/it] 44%|████▍     | 276/625 [18:19<23:06,  3.97s/it] 44%|████▍     | 277/625 [18:24<23:52,  4.12s/it] 44%|████▍     | 278/625 [18:27<22:27,  3.88s/it] 45%|████▍     | 279/625 [18:31<23:05,  4.00s/it] 45%|████▍     | 280/625 [18:36<23:38,  4.11s/it]                                                  45%|████▍     | 280/625 [18:36<23:38,  4.11s/it] 45%|████▍     | 281/625 [18:39<22:58,  4.01s/it] 45%|████▌     | 282/625 [18:43<22:58,  4.02s/it] 45%|████▌     | 283/625 [18:47<22:21,  3.92s/it] 45%|████▌     | 284/625 [18:51<21:40,  3.81s/it] 46%|████▌     | 285/625 [18:55<22:21,  3.94s/it] 46%|████▌     | 286/625 [18:59<22:53,  4.05s/it] 46%|████▌     | 287/625 [19:04<23:33,  4.18s/it] 46%|████▌     | 288/625 [19:08<23:20,  4.16s/it] 46%|████▌     | 289/625 [19:12<23:35,  4.21s/it] 46%|████▋     | 290/625 [19:16<23:35,  4.23s/it]                                                  46%|████▋     | 290/625 [19:16<23:35,  4.23s/it] 47%|████▋     | 291/625 [19:20<22:08,  3.98s/it] 47%|████▋     | 292/625 [19:24<21:40,  3.90s/it] 47%|████▋     | 293/625 [19:28<22:42,  4.10s/it] 47%|████▋     | 294/625 [19:32<21:41,  3.93s/it] 47%|████▋     | 295/625 [19:36<22:02,  4.01s/it] 47%|████▋     | 296/625 [19:40<21:37,  3.95s/it] 48%|████▊     | 297/625 [19:44<21:59,  4.02s/it] 48%|████▊     | 298/625 [19:47<20:55,  3.84s/it] 48%|████▊     | 299/625 [19:51<21:14,  3.91s/it] 48%|████▊     | 300/625 [19:57<23:21,  4.31s/it]                                                  48%|████▊     | 300/625 [19:57<23:21,  4.31s/it]/data/b22cs093/miniconda3/envs/dl/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
 48%|████▊     | 301/625 [20:02<24:24,  4.52s/it] 48%|████▊     | 302/625 [20:06<23:47,  4.42s/it] 48%|████▊     | 303/625 [20:10<23:16,  4.34s/it] 49%|████▊     | 304/625 [20:14<22:42,  4.24s/it] 49%|████▉     | 305/625 [20:18<21:41,  4.07s/it] 49%|████▉     | 306/625 [20:22<22:06,  4.16s/it] 49%|████▉     | 307/625 [20:26<21:19,  4.02s/it] 49%|████▉     | 308/625 [20:30<21:14,  4.02s/it] 49%|████▉     | 309/625 [20:33<20:52,  3.96s/it] 50%|████▉     | 310/625 [20:37<20:51,  3.97s/it]                                                  50%|████▉     | 310/625 [20:37<20:51,  3.97s/it] 50%|████▉     | 311/625 [20:41<20:15,  3.87s/it] 50%|████▉     | 312/625 [20:45<20:27,  3.92s/it] 50%|█████     | 313/625 [20:49<20:47,  4.00s/it] 50%|█████     | 314/625 [20:53<20:15,  3.91s/it] 50%|█████     | 315/625 [20:57<20:51,  4.04s/it] 51%|█████     | 316/625 [21:01<20:16,  3.94s/it] 51%|█████     | 317/625 [21:06<21:09,  4.12s/it] 51%|█████     | 318/625 [21:10<21:17,  4.16s/it] 51%|█████     | 319/625 [21:14<21:08,  4.15s/it] 51%|█████     | 320/625 [21:18<20:36,  4.05s/it]                                                  51%|█████     | 320/625 [21:18<20:36,  4.05s/it] 51%|█████▏    | 321/625 [21:22<21:14,  4.19s/it] 52%|█████▏    | 322/625 [21:26<20:40,  4.09s/it] 52%|█████▏    | 323/625 [21:30<20:10,  4.01s/it] 52%|█████▏    | 324/625 [21:34<20:38,  4.11s/it] 52%|█████▏    | 325/625 [21:39<21:01,  4.20s/it] 52%|█████▏    | 326/625 [21:43<20:46,  4.17s/it] 52%|█████▏    | 327/625 [21:47<20:00,  4.03s/it] 52%|█████▏    | 328/625 [21:51<20:01,  4.05s/it] 53%|█████▎    | 329/625 [21:55<19:56,  4.04s/it] 53%|█████▎    | 330/625 [21:59<20:04,  4.08s/it]                                                  53%|█████▎    | 330/625 [21:59<20:04,  4.08s/it] 53%|█████▎    | 331/625 [22:03<20:09,  4.11s/it] 53%|█████▎    | 332/625 [22:07<20:06,  4.12s/it] 53%|█████▎    | 333/625 [22:11<19:52,  4.08s/it] 53%|█████▎    | 334/625 [22:15<20:00,  4.13s/it] 54%|█████▎    | 335/625 [22:20<20:19,  4.20s/it] 54%|█████▍    | 336/625 [22:24<20:00,  4.16s/it] 54%|█████▍    | 337/625 [22:28<19:26,  4.05s/it] 54%|█████▍    | 338/625 [22:31<18:40,  3.90s/it] 54%|█████▍    | 339/625 [22:36<19:12,  4.03s/it] 54%|█████▍    | 340/625 [22:40<19:09,  4.03s/it]                                                  54%|█████▍    | 340/625 [22:40<19:09,  4.03s/it] 55%|█████▍    | 341/625 [22:44<19:09,  4.05s/it] 55%|█████▍    | 342/625 [22:47<18:03,  3.83s/it] 55%|█████▍    | 343/625 [22:51<17:37,  3.75s/it] 55%|█████▌    | 344/625 [22:55<18:05,  3.86s/it] 55%|█████▌    | 345/625 [22:59<18:02,  3.87s/it] 55%|█████▌    | 346/625 [23:02<17:43,  3.81s/it] 56%|█████▌    | 347/625 [23:06<17:43,  3.83s/it] 56%|█████▌    | 348/625 [23:10<18:08,  3.93s/it] 56%|█████▌    | 349/625 [23:14<18:08,  3.94s/it] 56%|█████▌    | 350/625 [23:18<17:44,  3.87s/it]                                                  56%|█████▌    | 350/625 [23:18<17:44,  3.87s/it] 56%|█████▌    | 351/625 [23:22<18:13,  3.99s/it] 56%|█████▋    | 352/625 [23:26<18:05,  3.98s/it] 56%|█████▋    | 353/625 [23:30<17:56,  3.96s/it] 57%|█████▋    | 354/625 [23:34<18:02,  3.99s/it] 57%|█████▋    | 355/625 [23:38<17:36,  3.91s/it] 57%|█████▋    | 356/625 [23:41<17:06,  3.82s/it] 57%|█████▋    | 357/625 [23:45<16:56,  3.79s/it] 57%|█████▋    | 358/625 [23:49<17:24,  3.91s/it] 57%|█████▋    | 359/625 [23:53<16:59,  3.83s/it] 58%|█████▊    | 360/625 [23:57<16:30,  3.74s/it]                                                  58%|█████▊    | 360/625 [23:57<16:30,  3.74s/it] 58%|█████▊    | 361/625 [24:00<16:38,  3.78s/it] 58%|█████▊    | 362/625 [24:04<16:04,  3.67s/it] 58%|█████▊    | 363/625 [24:08<16:17,  3.73s/it] 58%|█████▊    | 364/625 [24:12<17:07,  3.94s/it] 58%|█████▊    | 365/625 [24:16<16:45,  3.87s/it] 59%|█████▊    | 366/625 [24:20<16:31,  3.83s/it] 59%|█████▊    | 367/625 [24:24<16:43,  3.89s/it] 59%|█████▉    | 368/625 [24:28<16:52,  3.94s/it] 59%|█████▉    | 369/625 [24:31<16:20,  3.83s/it] 59%|█████▉    | 370/625 [24:35<16:23,  3.85s/it]                                                  59%|█████▉    | 370/625 [24:35<16:23,  3.85s/it] 59%|█████▉    | 371/625 [24:39<16:53,  3.99s/it] 60%|█████▉    | 372/625 [24:44<18:02,  4.28s/it] 60%|█████▉    | 373/625 [24:48<16:36,  3.96s/it] 60%|█████▉    | 374/625 [24:51<15:13,  3.64s/it] 60%|██████    | 375/625 [24:53<14:17,  3.43s/it] 60%|██████    | 376/625 [24:57<13:45,  3.32s/it] 60%|██████    | 377/625 [25:00<13:21,  3.23s/it] 60%|██████    | 378/625 [25:03<13:13,  3.21s/it] 61%|██████    | 379/625 [25:06<13:44,  3.35s/it] 61%|██████    | 380/625 [25:10<14:20,  3.51s/it]                                                  61%|██████    | 380/625 [25:10<14:20,  3.51s/it] 61%|██████    | 381/625 [25:15<15:18,  3.76s/it] 61%|██████    | 382/625 [25:18<15:05,  3.73s/it] 61%|██████▏   | 383/625 [25:23<16:09,  4.01s/it] 61%|██████▏   | 384/625 [25:27<16:25,  4.09s/it] 62%|██████▏   | 385/625 [25:31<16:32,  4.14s/it] 62%|██████▏   | 386/625 [25:35<16:03,  4.03s/it] 62%|██████▏   | 387/625 [25:39<16:01,  4.04s/it] 62%|██████▏   | 388/625 [25:43<15:31,  3.93s/it] 62%|██████▏   | 389/625 [25:47<15:18,  3.89s/it] 62%|██████▏   | 390/625 [25:51<15:15,  3.89s/it]                                                  62%|██████▏   | 390/625 [25:51<15:15,  3.89s/it] 63%|██████▎   | 391/625 [25:54<14:58,  3.84s/it] 63%|██████▎   | 392/625 [25:58<14:59,  3.86s/it] 63%|██████▎   | 393/625 [26:02<15:13,  3.94s/it] 63%|██████▎   | 394/625 [26:06<15:11,  3.95s/it] 63%|██████▎   | 395/625 [26:10<14:50,  3.87s/it] 63%|██████▎   | 396/625 [26:14<14:57,  3.92s/it] 64%|██████▎   | 397/625 [26:18<14:45,  3.89s/it] 64%|██████▎   | 398/625 [26:22<14:36,  3.86s/it] 64%|██████▍   | 399/625 [26:26<14:35,  3.87s/it] 64%|██████▍   | 400/625 [26:29<14:31,  3.87s/it]                                                  64%|██████▍   | 400/625 [26:30<14:31,  3.87s/it]/data/b22cs093/miniconda3/envs/dl/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
 64%|██████▍   | 401/625 [26:34<15:39,  4.19s/it] 64%|██████▍   | 402/625 [26:38<15:10,  4.08s/it] 64%|██████▍   | 403/625 [26:42<15:00,  4.06s/it] 65%|██████▍   | 404/625 [26:46<14:31,  3.94s/it] 65%|██████▍   | 405/625 [26:50<14:50,  4.05s/it] 65%|██████▍   | 406/625 [26:54<14:11,  3.89s/it] 65%|██████▌   | 407/625 [26:58<14:26,  3.97s/it] 65%|██████▌   | 408/625 [27:02<14:03,  3.89s/it] 65%|██████▌   | 409/625 [27:06<14:07,  3.92s/it] 66%|██████▌   | 410/625 [27:09<13:32,  3.78s/it]                                                 {'loss': 0.0518, 'grad_norm': 0.41376838088035583, 'learning_rate': 6.656e-06, 'rewards/chosen': 5.77384090423584, 'rewards/rejected': 1.428375482559204, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 4.345465183258057, 'logps/chosen': -25.284276962280273, 'logps/rejected': -75.40872192382812, 'logits/chosen': -3.380112409591675, 'logits/rejected': -3.322289228439331, 'epoch': 0.34}
{'loss': 0.0569, 'grad_norm': 0.9016980528831482, 'learning_rate': 6.496e-06, 'rewards/chosen': 5.744635105133057, 'rewards/rejected': 1.3748648166656494, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 4.369770050048828, 'logps/chosen': -24.915775299072266, 'logps/rejected': -76.29558563232422, 'logits/chosen': -3.442349672317505, 'logits/rejected': -3.4132914543151855, 'epoch': 0.35}
{'loss': 0.0545, 'grad_norm': 0.7723779678344727, 'learning_rate': 6.336000000000001e-06, 'rewards/chosen': 5.761689186096191, 'rewards/rejected': 1.5305639505386353, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 4.231125831604004, 'logps/chosen': -23.043575286865234, 'logps/rejected': -73.23622131347656, 'logits/chosen': -3.484086275100708, 'logits/rejected': -3.44073486328125, 'epoch': 0.37}
{'loss': 0.0471, 'grad_norm': 0.30747419595718384, 'learning_rate': 6.176000000000001e-06, 'rewards/chosen': 5.636557102203369, 'rewards/rejected': 0.9874095916748047, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 4.649147987365723, 'logps/chosen': -24.03989028930664, 'logps/rejected': -76.50860595703125, 'logits/chosen': -3.5094070434570312, 'logits/rejected': -3.4567131996154785, 'epoch': 0.38}
{'loss': 0.0689, 'grad_norm': 0.46078819036483765, 'learning_rate': 6.0160000000000005e-06, 'rewards/chosen': 5.566671848297119, 'rewards/rejected': 1.2153698205947876, 'rewards/accuracies': 0.9624999761581421, 'rewards/margins': 4.351302146911621, 'logps/chosen': -25.689453125, 'logps/rejected': -76.18218231201172, 'logits/chosen': -3.432033061981201, 'logits/rejected': -3.4242281913757324, 'epoch': 0.4}
{'loss': 0.0506, 'grad_norm': 0.23535779118537903, 'learning_rate': 5.856e-06, 'rewards/chosen': 5.5583696365356445, 'rewards/rejected': 1.0298417806625366, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 4.528528213500977, 'logps/chosen': -25.247901916503906, 'logps/rejected': -76.49405670166016, 'logits/chosen': -3.570175886154175, 'logits/rejected': -3.4654018878936768, 'epoch': 0.42}
{'loss': 0.032, 'grad_norm': 0.08386874198913574, 'learning_rate': 5.696e-06, 'rewards/chosen': 5.74731969833374, 'rewards/rejected': 1.1383612155914307, 'rewards/accuracies': 1.0, 'rewards/margins': 4.608957767486572, 'logps/chosen': -25.135316848754883, 'logps/rejected': -80.38715362548828, 'logits/chosen': -3.5453827381134033, 'logits/rejected': -3.4930739402770996, 'epoch': 0.43}
{'loss': 0.033, 'grad_norm': 0.11186598986387253, 'learning_rate': 5.536e-06, 'rewards/chosen': 5.792366027832031, 'rewards/rejected': 0.9874696731567383, 'rewards/accuracies': 0.9937499761581421, 'rewards/margins': 4.804896831512451, 'logps/chosen': -26.566781997680664, 'logps/rejected': -81.9763412475586, 'logits/chosen': -3.4569079875946045, 'logits/rejected': -3.4419963359832764, 'epoch': 0.45}
{'loss': 0.0369, 'grad_norm': 0.3627261221408844, 'learning_rate': 5.376e-06, 'rewards/chosen': 5.7149858474731445, 'rewards/rejected': 0.9378384351730347, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 4.77714729309082, 'logps/chosen': -23.023767471313477, 'logps/rejected': -79.3133773803711, 'logits/chosen': -3.6154708862304688, 'logits/rejected': -3.5413997173309326, 'epoch': 0.46}
{'loss': 0.0542, 'grad_norm': 0.11850179731845856, 'learning_rate': 5.216e-06, 'rewards/chosen': 5.5157623291015625, 'rewards/rejected': 0.8316981196403503, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 4.684063911437988, 'logps/chosen': -22.648235321044922, 'logps/rejected': -76.61507415771484, 'logits/chosen': -3.444582462310791, 'logits/rejected': -3.4083123207092285, 'epoch': 0.48}
{'loss': 0.0439, 'grad_norm': 0.29712703824043274, 'learning_rate': 5.056000000000001e-06, 'rewards/chosen': 5.634470462799072, 'rewards/rejected': 0.9794293642044067, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 4.655040740966797, 'logps/chosen': -22.244853973388672, 'logps/rejected': -75.56867218017578, 'logits/chosen': -3.371356248855591, 'logits/rejected': -3.306966781616211, 'epoch': 0.5}
{'loss': 0.0392, 'grad_norm': 0.7182634472846985, 'learning_rate': 4.896e-06, 'rewards/chosen': 5.790956974029541, 'rewards/rejected': 1.087966799736023, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 4.70298957824707, 'logps/chosen': -24.522626876831055, 'logps/rejected': -79.55472564697266, 'logits/chosen': -3.4906723499298096, 'logits/rejected': -3.4587225914001465, 'epoch': 0.51}
{'loss': 0.0344, 'grad_norm': 0.16510353982448578, 'learning_rate': 4.736000000000001e-06, 'rewards/chosen': 5.492435932159424, 'rewards/rejected': 0.8309348225593567, 'rewards/accuracies': 1.0, 'rewards/margins': 4.661501407623291, 'logps/chosen': -26.0535831451416, 'logps/rejected': -81.07621765136719, 'logits/chosen': -3.5417542457580566, 'logits/rejected': -3.49200177192688, 'epoch': 0.53}
{'loss': 0.0498, 'grad_norm': 0.17785629630088806, 'learning_rate': 4.576000000000001e-06, 'rewards/chosen': 5.473428726196289, 'rewards/rejected': 0.5546051263809204, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 4.918823719024658, 'logps/chosen': -25.425804138183594, 'logps/rejected': -81.55845642089844, 'logits/chosen': -3.5280356407165527, 'logits/rejected': -3.4885993003845215, 'epoch': 0.54}
{'loss': 0.0308, 'grad_norm': 0.4555099904537201, 'learning_rate': 4.416000000000001e-06, 'rewards/chosen': 5.3787031173706055, 'rewards/rejected': 0.19674119353294373, 'rewards/accuracies': 0.9937499761581421, 'rewards/margins': 5.181962013244629, 'logps/chosen': -27.344818115234375, 'logps/rejected': -86.8726806640625, 'logits/chosen': -3.5282301902770996, 'logits/rejected': -3.502450466156006, 'epoch': 0.56}
{'loss': 0.035, 'grad_norm': 0.43346527218818665, 'learning_rate': 4.256e-06, 'rewards/chosen': 5.3869500160217285, 'rewards/rejected': 0.48792776465415955, 'rewards/accuracies': 0.9937499761581421, 'rewards/margins': 4.899022102355957, 'logps/chosen': -27.3410587310791, 'logps/rejected': -84.47965240478516, 'logits/chosen': -3.4821667671203613, 'logits/rejected': -3.4582619667053223, 'epoch': 0.58}
{'loss': 0.0459, 'grad_norm': 2.434447765350342, 'learning_rate': 4.096e-06, 'rewards/chosen': 5.44578742980957, 'rewards/rejected': 0.5918471813201904, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 4.853940486907959, 'logps/chosen': -26.3741512298584, 'logps/rejected': -83.25287628173828, 'logits/chosen': -3.4260165691375732, 'logits/rejected': -3.389805316925049, 'epoch': 0.59}
{'loss': 0.0468, 'grad_norm': 0.382922500371933, 'learning_rate': 3.936e-06, 'rewards/chosen': 5.25009822845459, 'rewards/rejected': 0.4047837257385254, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 4.845314979553223, 'logps/chosen': -26.061025619506836, 'logps/rejected': -80.70066833496094, 'logits/chosen': -3.531672954559326, 'logits/rejected': -3.4745242595672607, 'epoch': 0.61}
{'loss': 0.044, 'grad_norm': 0.375563383102417, 'learning_rate': 3.7760000000000004e-06, 'rewards/chosen': 5.235653400421143, 'rewards/rejected': 0.28596365451812744, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 4.9496893882751465, 'logps/chosen': -30.09706687927246, 'logps/rejected': -87.16102600097656, 'logits/chosen': -3.4226009845733643, 'logits/rejected': -3.390965700149536, 'epoch': 0.62}
{'loss': 0.0299, 'grad_norm': 0.19601374864578247, 'learning_rate': 3.616e-06, 'rewards/chosen': 5.468210220336914, 'rewards/rejected': 0.4344756603240967, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 5.0337347984313965, 'logps/chosen': -23.994220733642578, 'logps/rejected': -81.88233947753906, 'logits/chosen': -3.537365674972534, 'logits/rejected': -3.50154185295105, 'epoch': 0.64}
 66%|██████▌   | 410/625 [27:09<13:32,  3.78s/it] 66%|██████▌   | 411/625 [27:13<14:11,  3.98s/it] 66%|██████▌   | 412/625 [27:17<13:59,  3.94s/it] 66%|██████▌   | 413/625 [27:21<13:32,  3.83s/it] 66%|██████▌   | 414/625 [27:25<13:32,  3.85s/it] 66%|██████▋   | 415/625 [27:28<12:46,  3.65s/it] 67%|██████▋   | 416/625 [27:31<12:01,  3.45s/it] 67%|██████▋   | 417/625 [27:34<11:35,  3.35s/it] 67%|██████▋   | 418/625 [27:37<11:23,  3.30s/it] 67%|██████▋   | 419/625 [27:40<11:06,  3.24s/it] 67%|██████▋   | 420/625 [27:43<10:46,  3.15s/it]                                                  67%|██████▋   | 420/625 [27:43<10:46,  3.15s/it] 67%|██████▋   | 421/625 [27:46<10:43,  3.15s/it] 68%|██████▊   | 422/625 [27:50<10:40,  3.16s/it] 68%|██████▊   | 423/625 [27:53<10:21,  3.08s/it] 68%|██████▊   | 424/625 [27:56<10:44,  3.21s/it] 68%|██████▊   | 425/625 [28:00<11:13,  3.37s/it] 68%|██████▊   | 426/625 [28:03<10:59,  3.31s/it] 68%|██████▊   | 427/625 [28:06<10:53,  3.30s/it] 68%|██████▊   | 428/625 [28:10<11:06,  3.38s/it] 69%|██████▊   | 429/625 [28:13<10:39,  3.26s/it] 69%|██████▉   | 430/625 [28:16<10:56,  3.37s/it]                                                  69%|██████▉   | 430/625 [28:16<10:56,  3.37s/it] 69%|██████▉   | 431/625 [28:20<10:47,  3.34s/it] 69%|██████▉   | 432/625 [28:23<10:19,  3.21s/it] 69%|██████▉   | 433/625 [28:25<09:55,  3.10s/it] 69%|██████▉   | 434/625 [28:28<09:36,  3.02s/it] 70%|██████▉   | 435/625 [28:31<09:40,  3.05s/it] 70%|██████▉   | 436/625 [28:34<09:34,  3.04s/it] 70%|██████▉   | 437/625 [28:37<09:25,  3.01s/it] 70%|███████   | 438/625 [28:40<09:24,  3.02s/it] 70%|███████   | 439/625 [28:43<09:09,  2.95s/it] 70%|███████   | 440/625 [28:46<09:14,  3.00s/it]                                                  70%|███████   | 440/625 [28:46<09:14,  3.00s/it] 71%|███████   | 441/625 [28:49<09:01,  2.94s/it] 71%|███████   | 442/625 [28:52<08:58,  2.94s/it] 71%|███████   | 443/625 [28:55<09:14,  3.05s/it] 71%|███████   | 444/625 [28:58<09:16,  3.07s/it] 71%|███████   | 445/625 [29:01<09:07,  3.04s/it] 71%|███████▏  | 446/625 [29:05<09:17,  3.12s/it] 72%|███████▏  | 447/625 [29:07<08:52,  2.99s/it] 72%|███████▏  | 448/625 [29:11<09:03,  3.07s/it] 72%|███████▏  | 449/625 [29:14<09:18,  3.17s/it] 72%|███████▏  | 450/625 [29:17<09:03,  3.10s/it]                                                  72%|███████▏  | 450/625 [29:17<09:03,  3.10s/it] 72%|███████▏  | 451/625 [29:20<08:34,  2.96s/it] 72%|███████▏  | 452/625 [29:23<08:38,  3.00s/it] 72%|███████▏  | 453/625 [29:25<08:16,  2.89s/it] 73%|███████▎  | 454/625 [29:28<08:22,  2.94s/it] 73%|███████▎  | 455/625 [29:32<08:30,  3.00s/it] 73%|███████▎  | 456/625 [29:35<08:24,  2.98s/it] 73%|███████▎  | 457/625 [29:37<08:13,  2.94s/it] 73%|███████▎  | 458/625 [29:40<08:07,  2.92s/it] 73%|███████▎  | 459/625 [29:43<08:01,  2.90s/it] 74%|███████▎  | 460/625 [29:46<08:18,  3.02s/it]                                                  74%|███████▎  | 460/625 [29:46<08:18,  3.02s/it] 74%|███████▍  | 461/625 [29:50<08:36,  3.15s/it] 74%|███████▍  | 462/625 [29:53<08:22,  3.08s/it] 74%|███████▍  | 463/625 [29:56<08:07,  3.01s/it] 74%|███████▍  | 464/625 [29:59<08:31,  3.17s/it] 74%|███████▍  | 465/625 [30:02<08:30,  3.19s/it] 75%|███████▍  | 466/625 [30:06<08:35,  3.24s/it] 75%|███████▍  | 467/625 [30:09<08:16,  3.14s/it] 75%|███████▍  | 468/625 [30:12<08:05,  3.09s/it] 75%|███████▌  | 469/625 [30:15<07:55,  3.05s/it] 75%|███████▌  | 470/625 [30:18<08:00,  3.10s/it]                                                  75%|███████▌  | 470/625 [30:18<08:00,  3.10s/it] 75%|███████▌  | 471/625 [30:21<07:58,  3.11s/it] 76%|███████▌  | 472/625 [30:24<07:43,  3.03s/it] 76%|███████▌  | 473/625 [30:27<07:37,  3.01s/it] 76%|███████▌  | 474/625 [30:30<07:51,  3.12s/it] 76%|███████▌  | 475/625 [30:33<07:32,  3.01s/it] 76%|███████▌  | 476/625 [30:36<07:49,  3.15s/it] 76%|███████▋  | 477/625 [30:40<07:52,  3.19s/it] 76%|███████▋  | 478/625 [30:43<07:36,  3.11s/it] 77%|███████▋  | 479/625 [30:45<07:19,  3.01s/it] 77%|███████▋  | 480/625 [30:48<07:12,  2.98s/it]                                                  77%|███████▋  | 480/625 [30:48<07:12,  2.98s/it] 77%|███████▋  | 481/625 [30:51<07:04,  2.94s/it] 77%|███████▋  | 482/625 [30:54<07:09,  3.01s/it] 77%|███████▋  | 483/625 [30:57<07:02,  2.98s/it] 77%|███████▋  | 484/625 [31:00<06:58,  2.97s/it] 78%|███████▊  | 485/625 [31:03<06:55,  2.97s/it] 78%|███████▊  | 486/625 [31:06<06:56,  3.00s/it] 78%|███████▊  | 487/625 [31:09<06:57,  3.03s/it] 78%|███████▊  | 488/625 [31:13<07:11,  3.15s/it] 78%|███████▊  | 489/625 [31:16<07:09,  3.16s/it] 78%|███████▊  | 490/625 [31:19<06:50,  3.04s/it]                                                  78%|███████▊  | 490/625 [31:19<06:50,  3.04s/it] 79%|███████▊  | 491/625 [31:22<06:46,  3.03s/it] 79%|███████▊  | 492/625 [31:25<06:47,  3.07s/it] 79%|███████▉  | 493/625 [31:28<06:42,  3.05s/it] 79%|███████▉  | 494/625 [31:31<06:41,  3.07s/it] 79%|███████▉  | 495/625 [31:34<06:36,  3.05s/it] 79%|███████▉  | 496/625 [31:37<06:40,  3.11s/it] 80%|███████▉  | 497/625 [31:41<07:03,  3.31s/it] 80%|███████▉  | 498/625 [31:44<06:49,  3.22s/it] 80%|███████▉  | 499/625 [31:47<06:34,  3.13s/it] 80%|████████  | 500/625 [31:50<06:22,  3.06s/it]                                                  80%|████████  | 500/625 [31:50<06:22,  3.06s/it]/data/b22cs093/miniconda3/envs/dl/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
 80%|████████  | 501/625 [31:54<06:50,  3.31s/it] 80%|████████  | 502/625 [31:57<06:35,  3.22s/it] 80%|████████  | 503/625 [32:00<06:24,  3.15s/it] 81%|████████  | 504/625 [32:03<06:22,  3.16s/it] 81%|████████  | 505/625 [32:06<06:13,  3.11s/it] 81%|████████  | 506/625 [32:09<06:15,  3.15s/it] 81%|████████  | 507/625 [32:12<06:17,  3.20s/it] 81%|████████▏ | 508/625 [32:15<06:03,  3.11s/it] 81%|████████▏ | 509/625 [32:18<05:57,  3.08s/it] 82%|████████▏ | 510/625 [32:21<05:52,  3.06s/it]                                                  82%|████████▏ | 510/625 [32:21<05:52,  3.06s/it] 82%|████████▏ | 511/625 [32:25<06:05,  3.20s/it] 82%|████████▏ | 512/625 [32:28<05:58,  3.17s/it] 82%|████████▏ | 513/625 [32:31<05:40,  3.04s/it] 82%|████████▏ | 514/625 [32:34<05:36,  3.03s/it] 82%|████████▏ | 515/625 [32:37<05:32,  3.03s/it] 83%|████████▎ | 516/625 [32:40<05:30,  3.03s/it] 83%|████████▎ | 517/625 [32:43<05:24,  3.00s/it] 83%|████████▎ | 518/625 [32:46<05:20,  2.99s/it] 83%|████████▎ | 519/625 [32:49<05:33,  3.15s/it] 83%|████████▎ | 520/625 [32:52<05:18,  3.03s/it]                                                  83%|████████▎ | 520/625 [32:52<05:18,  3.03s/it] 83%|████████▎ | 521/625 [32:55<05:22,  3.10s/it] 84%|████████▎ | 522/625 [32:58<05:08,  3.00s/it] 84%|████████▎ | 523/625 [33:01<05:04,  2.98s/it] 84%|████████▍ | 524/625 [33:04<05:08,  3.06s/it] 84%|████████▍ | 525/625 [33:07<05:08,  3.09s/it] 84%|████████▍ | 526/625 [33:11<05:13,  3.17s/it] 84%|████████▍ | 527/625 [33:13<05:00,  3.07s/it] 84%|████████▍ | 528/625 [33:16<04:49,  2.98s/it] 85%|████████▍ | 529/625 [33:19<04:50,  3.03s/it] 85%|████████▍ | 530/625 [33:22<04:45,  3.01s/it]                                                  85%|████████▍ | 530/625 [33:22<04:45,  3.01s/it] 85%|████████▍ | 531/625 [33:25<04:41,  2.99s/it] 85%|████████▌ | 532/625 [33:29<04:46,  3.08s/it] 85%|████████▌ | 533/625 [33:31<04:35,  3.00s/it] 85%|████████▌ | 534/625 [33:35<04:43,  3.11s/it] 86%|████████▌ | 535/625 [33:38<04:38,  3.10s/it] 86%|████████▌ | 536/625 [33:41<04:27,  3.00s/it] 86%|████████▌ | 537/625 [33:44<04:28,  3.05s/it] 86%|████████▌ | 538/625 [33:47<04:24,  3.04s/it] 86%|████████▌ | 539/625 [33:50<04:24,  3.08s/it] 86%|████████▋ | 540/625 [33:53<04:21,  3.08s/it]                                                  86%|████████▋ | 540/625 [33:53<04:21,  3.08s/it] 87%|████████▋ | 541/625 [33:56<04:17,  3.07s/it] 87%|████████▋ | 542/625 [33:59<04:22,  3.16s/it] 87%|████████▋ | 543/625 [34:02<04:14,  3.10s/it] 87%|████████▋ | 544/625 [34:06<04:11,  3.10s/it] 87%|████████▋ | 545/625 [34:08<04:03,  3.04s/it] 87%|████████▋ | 546/625 [34:11<03:53,  2.96s/it] 88%|████████▊ | 547/625 [34:14<03:48,  2.93s/it] 88%|████████▊ | 548/625 [34:17<03:51,  3.01s/it] 88%|████████▊ | 549/625 [34:20<03:45,  2.96s/it] 88%|████████▊ | 550/625 [34:24<03:54,  3.13s/it]                                                  88%|████████▊ | 550/625 [34:24<03:54,  3.13s/it] 88%|████████▊ | 551/625 [34:26<03:44,  3.04s/it] 88%|████████▊ | 552/625 [34:29<03:36,  2.97s/it] 88%|████████▊ | 553/625 [34:32<03:31,  2.93s/it] 89%|████████▊ | 554/625 [34:35<03:32,  2.99s/it] 89%|████████▉ | 555/625 [34:38<03:30,  3.01s/it] 89%|████████▉ | 556/625 [34:41<03:29,  3.04s/it] 89%|████████▉ | 557/625 [34:44<03:22,  2.97s/it] 89%|████████▉ | 558/625 [34:48<03:29,  3.12s/it] 89%|████████▉ | 559/625 [34:51<03:22,  3.07s/it] 90%|████████▉ | 560/625 [34:54<03:25,  3.16s/it]                                                  90%|████████▉ | 560/625 [34:54<03:25,  3.16s/it] 90%|████████▉ | 561/625 [34:57<03:28,  3.26s/it] 90%|████████▉ | 562/625 [35:01<03:21,  3.20s/it] 90%|█████████ | 563/625 [35:04<03:17,  3.19s/it] 90%|█████████ | 564/625 [35:07<03:15,  3.20s/it] 90%|█████████ | 565/625 [35:10<03:07,  3.12s/it] 91%|█████████ | 566/625 [35:13<03:01,  3.08s/it] 91%|█████████ | 567/625 [35:16<02:55,  3.03s/it] 91%|█████████ | 568/625 [35:19<02:59,  3.15s/it] 91%|█████████ | 569/625 [35:22<02:55,  3.13s/it] 91%|█████████ | 570/625 [35:25<02:51,  3.12s/it]                                                  91%|█████████ | 570/625 [35:25<02:51,  3.12s/it] 91%|█████████▏| 571/625 [35:29<02:50,  3.15s/it] 92%|█████████▏| 572/625 [35:32<02:50,  3.21s/it] 92%|█████████▏| 573/625 [35:35<02:43,  3.15s/it] 92%|█████████▏| 574/625 [35:38<02:37,  3.08s/it] 92%|█████████▏| 575/625 [35:41<02:36,  3.13s/it] 92%|█████████▏| 576/625 [35:44<02:29,  3.04s/it] 92%|█████████▏| 577/625 [35:47<02:23,  2.99s/it] 92%|█████████▏| 578/625 [35:50<02:20,  2.99s/it] 93%|█████████▎| 579/625 [35:54<02:29,  3.25s/it] 93%|█████████▎| 580/625 [35:57<02:22,  3.18s/it]                                                  93%|█████████▎| 580/625 [35:57<02:22,  3.18s/it] 93%|█████████▎| 581/625 [36:00<02:24,  3.29s/it] 93%|█████████▎| 582/625 [36:03<02:17,  3.19s/it] 93%|█████████▎| 583/625 [36:06<02:13,  3.18s/it] 93%|█████████▎| 584/625 [36:09<02:06,  3.09s/it] 94%|█████████▎| 585/625 [36:12<01:59,  3.00s/it] 94%|█████████▍| 586/625 [36:15<01:55,  2.96s/it] 94%|█████████▍| 587/625 [36:18<01:54,  3.00s/it] 94%|█████████▍| 588/625 [36:21<01:50,  2.98s/it] 94%|█████████▍| 589/625 [36:24<01:48,  3.03s/it] 94%|█████████▍| 590/625 [36:27<01:44,  2.99s/it]                                                  94%|█████████▍| 590/625 [36:27<01:44,  2.99s/it] 95%|█████████▍| 591/625 [36:30<01:42,  3.02s/it] 95%|█████████▍| 592/625 [36:33<01:39,  3.00s/it] 95%|█████████▍| 593/625 [36:36<01:35,  3.00s/it] 95%|█████████▌| 594/625 [36:39<01:32,  2.97s/it] 95%|█████████▌| 595/625 [36:42<01:29,  2.98s/it] 95%|█████████▌| 596/625 [36:45<01:28,  3.05s/it] 96%|█████████▌| 597/625 [36:49<01:29,  3.18s/it] 96%|█████████▌| 598/625 [36:52<01:24,  3.13s/it] 96%|█████████▌| 599/625 [36:55<01:22,  3.16s/it] 96%|█████████▌| 600/625 [36:58<01:18,  3.13s/it]                                                  96%|█████████▌| 600/625 [36:58<01:18,  3.13s/it]/data/b22cs093/miniconda3/envs/dl/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
 96%|█████████▌| 601/625 [37:02<01:21,  3.40s/it] 96%|█████████▋| 602/625 [37:05<01:15,  3.27s/it] 96%|█████████▋| 603/625 [37:08<01:09,  3.18s/it] 97%|█████████▋| 604/625 [37:11<01:05,  3.13s/it] 97%|█████████▋| 605/625 [37:14<01:02,  3.11s/it] 97%|█████████▋| 606/625 [37:17<00:59,  3.12s/it] 97%|█████████▋| 607/625 [37:21<00:58,  3.24s/it] 97%|█████████▋| 608/625 [37:24<00:54,  3.20s/it] 97%|█████████▋| 609/625 [37:27<00:51,  3.22s/it] 98%|█████████▊| 610/625 [37:30<00:47,  3.16s/it]                                                 {'loss': 0.0497, 'grad_norm': 0.17851047217845917, 'learning_rate': 3.4560000000000005e-06, 'rewards/chosen': 5.245540618896484, 'rewards/rejected': 0.12736372649669647, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 5.118176460266113, 'logps/chosen': -31.594905853271484, 'logps/rejected': -90.24691009521484, 'logits/chosen': -3.420880079269409, 'logits/rejected': -3.3739638328552246, 'epoch': 0.66}
{'loss': 0.0332, 'grad_norm': 0.32491937279701233, 'learning_rate': 3.2960000000000003e-06, 'rewards/chosen': 5.207153797149658, 'rewards/rejected': 0.14644822478294373, 'rewards/accuracies': 1.0, 'rewards/margins': 5.06070613861084, 'logps/chosen': -30.316808700561523, 'logps/rejected': -88.76512145996094, 'logits/chosen': -3.4466335773468018, 'logits/rejected': -3.400131940841675, 'epoch': 0.67}
{'loss': 0.0264, 'grad_norm': 0.43750840425491333, 'learning_rate': 3.136e-06, 'rewards/chosen': 5.270801067352295, 'rewards/rejected': 0.12087982892990112, 'rewards/accuracies': 0.9937499761581421, 'rewards/margins': 5.149921894073486, 'logps/chosen': -28.18582534790039, 'logps/rejected': -87.64649200439453, 'logits/chosen': -3.667604446411133, 'logits/rejected': -3.5975537300109863, 'epoch': 0.69}
{'loss': 0.04, 'grad_norm': 0.5816717743873596, 'learning_rate': 2.976e-06, 'rewards/chosen': 4.988053321838379, 'rewards/rejected': -0.34951579570770264, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 5.337569236755371, 'logps/chosen': -29.792932510375977, 'logps/rejected': -90.30892181396484, 'logits/chosen': -3.536039352416992, 'logits/rejected': -3.513965606689453, 'epoch': 0.7}
{'loss': 0.033, 'grad_norm': 0.08316461741924286, 'learning_rate': 2.8160000000000002e-06, 'rewards/chosen': 5.323061943054199, 'rewards/rejected': -0.1642625778913498, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 5.487324237823486, 'logps/chosen': -27.872737884521484, 'logps/rejected': -91.24501037597656, 'logits/chosen': -3.624955654144287, 'logits/rejected': -3.5727272033691406, 'epoch': 0.72}
{'loss': 0.041, 'grad_norm': 0.44269415736198425, 'learning_rate': 2.656e-06, 'rewards/chosen': 5.263310432434082, 'rewards/rejected': 0.200951486825943, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 5.06235933303833, 'logps/chosen': -25.687564849853516, 'logps/rejected': -84.21879577636719, 'logits/chosen': -3.5450034141540527, 'logits/rejected': -3.512909412384033, 'epoch': 0.74}
{'loss': 0.0338, 'grad_norm': 0.25006675720214844, 'learning_rate': 2.496e-06, 'rewards/chosen': 5.264130592346191, 'rewards/rejected': 0.15287241339683533, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 5.111257553100586, 'logps/chosen': -27.451801300048828, 'logps/rejected': -87.47359466552734, 'logits/chosen': -3.5875205993652344, 'logits/rejected': -3.559022903442383, 'epoch': 0.75}
{'loss': 0.0278, 'grad_norm': 0.2748228907585144, 'learning_rate': 2.336e-06, 'rewards/chosen': 5.171096324920654, 'rewards/rejected': -0.09059295058250427, 'rewards/accuracies': 0.9937499761581421, 'rewards/margins': 5.261689186096191, 'logps/chosen': -27.93157386779785, 'logps/rejected': -88.32270812988281, 'logits/chosen': -3.5249335765838623, 'logits/rejected': -3.466841220855713, 'epoch': 0.77}
{'loss': 0.0334, 'grad_norm': 0.3273179829120636, 'learning_rate': 2.176e-06, 'rewards/chosen': 5.296717643737793, 'rewards/rejected': -0.04540105536580086, 'rewards/accuracies': 1.0, 'rewards/margins': 5.342118263244629, 'logps/chosen': -29.169445037841797, 'logps/rejected': -90.93499755859375, 'logits/chosen': -3.464481830596924, 'logits/rejected': -3.423999786376953, 'epoch': 0.78}
{'loss': 0.0297, 'grad_norm': 0.4395096004009247, 'learning_rate': 2.0160000000000003e-06, 'rewards/chosen': 5.099273681640625, 'rewards/rejected': -0.14114262163639069, 'rewards/accuracies': 0.9937499761581421, 'rewards/margins': 5.240416049957275, 'logps/chosen': -33.482566833496094, 'logps/rejected': -92.38175964355469, 'logits/chosen': -3.5556538105010986, 'logits/rejected': -3.508148193359375, 'epoch': 0.8}
{'loss': 0.0298, 'grad_norm': 0.09981254488229752, 'learning_rate': 1.856e-06, 'rewards/chosen': 5.007310390472412, 'rewards/rejected': -0.28174811601638794, 'rewards/accuracies': 0.9937499761581421, 'rewards/margins': 5.289058208465576, 'logps/chosen': -29.337387084960938, 'logps/rejected': -89.16877746582031, 'logits/chosen': -3.4643337726593018, 'logits/rejected': -3.4309070110321045, 'epoch': 0.82}
{'loss': 0.0337, 'grad_norm': 0.16505539417266846, 'learning_rate': 1.6960000000000002e-06, 'rewards/chosen': 5.47270393371582, 'rewards/rejected': 0.23047029972076416, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 5.242233753204346, 'logps/chosen': -23.9101505279541, 'logps/rejected': -83.9999008178711, 'logits/chosen': -3.581679582595825, 'logits/rejected': -3.540980577468872, 'epoch': 0.83}
{'loss': 0.0276, 'grad_norm': 0.9029103517532349, 'learning_rate': 1.536e-06, 'rewards/chosen': 5.117215156555176, 'rewards/rejected': -0.1457321047782898, 'rewards/accuracies': 1.0, 'rewards/margins': 5.2629475593566895, 'logps/chosen': -27.376964569091797, 'logps/rejected': -88.42042541503906, 'logits/chosen': -3.467278242111206, 'logits/rejected': -3.4138450622558594, 'epoch': 0.85}
{'loss': 0.0281, 'grad_norm': 0.5545448064804077, 'learning_rate': 1.376e-06, 'rewards/chosen': 4.881918430328369, 'rewards/rejected': -0.41300398111343384, 'rewards/accuracies': 1.0, 'rewards/margins': 5.294922828674316, 'logps/chosen': -29.66562271118164, 'logps/rejected': -89.240966796875, 'logits/chosen': -3.5994346141815186, 'logits/rejected': -3.587195873260498, 'epoch': 0.86}
{'loss': 0.0322, 'grad_norm': 0.31677746772766113, 'learning_rate': 1.216e-06, 'rewards/chosen': 5.14377498626709, 'rewards/rejected': -0.06985270977020264, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 5.213627815246582, 'logps/chosen': -28.101303100585938, 'logps/rejected': -88.11907958984375, 'logits/chosen': -3.548208713531494, 'logits/rejected': -3.4976322650909424, 'epoch': 0.88}
{'loss': 0.0338, 'grad_norm': 0.4426030218601227, 'learning_rate': 1.0560000000000001e-06, 'rewards/chosen': 5.248300552368164, 'rewards/rejected': -0.04114594683051109, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 5.2894463539123535, 'logps/chosen': -30.19671058654785, 'logps/rejected': -90.34468078613281, 'logits/chosen': -3.477734088897705, 'logits/rejected': -3.422217607498169, 'epoch': 0.9}
{'loss': 0.0323, 'grad_norm': 0.20586343109607697, 'learning_rate': 8.960000000000001e-07, 'rewards/chosen': 5.294327735900879, 'rewards/rejected': 0.0063374461606144905, 'rewards/accuracies': 0.9937499761581421, 'rewards/margins': 5.287990570068359, 'logps/chosen': -26.227951049804688, 'logps/rejected': -86.80424499511719, 'logits/chosen': -3.5345282554626465, 'logits/rejected': -3.4856948852539062, 'epoch': 0.91}
{'loss': 0.0409, 'grad_norm': 0.42454594373703003, 'learning_rate': 7.36e-07, 'rewards/chosen': 5.216092109680176, 'rewards/rejected': 0.01131466031074524, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 5.204777240753174, 'logps/chosen': -28.08428955078125, 'logps/rejected': -87.2495346069336, 'logits/chosen': -3.4391613006591797, 'logits/rejected': -3.4061214923858643, 'epoch': 0.93}
{'loss': 0.027, 'grad_norm': 0.17177431285381317, 'learning_rate': 5.760000000000001e-07, 'rewards/chosen': 5.265593528747559, 'rewards/rejected': -0.1825428456068039, 'rewards/accuracies': 0.987500011920929, 'rewards/margins': 5.448136329650879, 'logps/chosen': -26.379058837890625, 'logps/rejected': -89.02397155761719, 'logits/chosen': -3.604856014251709, 'logits/rejected': -3.5345330238342285, 'epoch': 0.94}
{'loss': 0.0414, 'grad_norm': 0.178929403424263, 'learning_rate': 4.16e-07, 'rewards/chosen': 5.0160040855407715, 'rewards/rejected': -0.41263094544410706, 'rewards/accuracies': 0.9750000238418579, 'rewards/margins': 5.428635597229004, 'logps/chosen': -31.510784149169922, 'logps/rejected': -94.71024322509766, 'logits/chosen': -3.542860746383667, 'logits/rejected': -3.4498143196105957, 'epoch': 0.96}
 98%|█████████▊| 610/625 [37:30<00:47,  3.16s/it] 98%|█████████▊| 611/625 [37:33<00:45,  3.25s/it] 98%|█████████▊| 612/625 [37:37<00:41,  3.18s/it] 98%|█████████▊| 613/625 [37:40<00:38,  3.19s/it] 98%|█████████▊| 614/625 [37:43<00:34,  3.16s/it] 98%|█████████▊| 615/625 [37:46<00:31,  3.10s/it] 99%|█████████▊| 616/625 [37:49<00:27,  3.07s/it] 99%|█████████▊| 617/625 [37:52<00:24,  3.04s/it] 99%|█████████▉| 618/625 [37:55<00:20,  2.97s/it] 99%|█████████▉| 619/625 [37:58<00:18,  3.01s/it] 99%|█████████▉| 620/625 [38:01<00:15,  3.04s/it]                                                  99%|█████████▉| 620/625 [38:01<00:15,  3.04s/it] 99%|█████████▉| 621/625 [38:04<00:12,  3.07s/it]100%|█████████▉| 622/625 [38:07<00:09,  3.03s/it]100%|█████████▉| 623/625 [38:10<00:05,  2.99s/it]100%|█████████▉| 624/625 [38:13<00:02,  2.97s/it]100%|██████████| 625/625 [38:16<00:00,  3.02s/it]                                                 100%|██████████| 625/625 [38:17<00:00,  3.02s/it]100%|██████████| 625/625 [38:17<00:00,  3.68s/it]
{'loss': 0.0406, 'grad_norm': 0.12082954496145248, 'learning_rate': 2.56e-07, 'rewards/chosen': 5.143897533416748, 'rewards/rejected': -0.14432208240032196, 'rewards/accuracies': 0.981249988079071, 'rewards/margins': 5.288218975067139, 'logps/chosen': -28.665699005126953, 'logps/rejected': -86.76396179199219, 'logits/chosen': -3.6030635833740234, 'logits/rejected': -3.5258116722106934, 'epoch': 0.98}
{'loss': 0.0213, 'grad_norm': 0.368000864982605, 'learning_rate': 9.6e-08, 'rewards/chosen': 5.18487548828125, 'rewards/rejected': -0.1341102421283722, 'rewards/accuracies': 1.0, 'rewards/margins': 5.318985462188721, 'logps/chosen': -30.07668685913086, 'logps/rejected': -90.53086853027344, 'logits/chosen': -3.5505943298339844, 'logits/rejected': -3.5226528644561768, 'epoch': 0.99}
{'train_runtime': 2297.0285, 'train_samples_per_second': 4.353, 'train_steps_per_second': 0.272, 'train_loss': 0.06076689530611038, 'epoch': 1.0}
DPO Training finished.
DPO Model saved.
